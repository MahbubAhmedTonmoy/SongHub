@model IEnumerable<GigHub.Models.Gig>
@{
	ViewBag.Title = "Mine";
}

<h2>My upcomming Gig</h2>

<ul class="gigs">
	@foreach (var gig in Model)
	{
		<li>
			<div class="date">
				<div class="month">
					@gig.DateTime.ToString("MMM")
				</div>
				<div class="day">
					@gig.DateTime.ToString("d ")
				</div>
			</div>
			<div class="details">
				<span class="artist">
					@gig.Venue
				</span>
				<span class="genre">
					@gig.Genre.Name
				</span>
				<div class="actions">
					<a href="@Url.Action("Edit", "Gigs", new {id = gig.Id})" >Edit</a>
					<a href="" class="js-cancle-gig" data-gig-id="@gig.Id"> Cancle</a>
				</div>

			</div>
		</li>
	}
</ul>


@section scripts
{ 
	<script>
		$(document).ready(function () {
			$(".js-cancle-gig").click(function (e) {
				var link = $(e.target);
				
				bootbox.dialog({
    title: 'Confirm',
    message: "Are you sure you want to cancle this gig?",
    buttons: {
        no: {
            label: "No",
            className: 'btn-default',
            callback: function(){
               bootbox.hideAll;
            }
        },
        yes: {
            label: "Yes",
            className: 'btn-danger',
            callback: function(){
                $.ajax({
						url: "/api/gigs" + link.attr("data-gig-id"),
						method: "DELETE"
					})
						.done(function () {
							link.parent("li").fadeOut(function () {
								$(this).remove();
							})
						})
						.fail(function() {
							alert("something wrong");
						});
            }
        }
      
    }
});
				
				
			
				
			});
		});
	</script>
}